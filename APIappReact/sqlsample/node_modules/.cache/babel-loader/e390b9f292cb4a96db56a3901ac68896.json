{"ast":null,"code":"'use strict';\n\nconst TYPES = require('./datatypes').TYPES;\n\nconst Table = require('./table');\n\nlet PromiseLibrary = Promise;\nconst driver = {};\nconst map = [];\n/**\r\n * Register you own type map.\r\n *\r\n * @path module.exports.map\r\n * @param {*} jstype JS data type.\r\n * @param {*} sqltype SQL data type.\r\n */\n\nmap.register = function (jstype, sqltype) {\n  for (let index = 0; index < this.length; index++) {\n    const item = this[index];\n\n    if (item.js === jstype) {\n      this.splice(index, 1);\n      break;\n    }\n  }\n\n  this.push({\n    js: jstype,\n    sql: sqltype\n  });\n  return null;\n};\n\nmap.register(String, TYPES.NVarChar);\nmap.register(Number, TYPES.Int);\nmap.register(Boolean, TYPES.Bit);\nmap.register(Date, TYPES.DateTime);\nmap.register(Buffer, TYPES.VarBinary);\nmap.register(Table, TYPES.TVP);\n/**\r\n * @ignore\r\n */\n\nconst getTypeByValue = function (value) {\n  if (value === null || value === undefined) {\n    return TYPES.NVarChar;\n  }\n\n  switch (typeof value) {\n    case 'string':\n      for (var item of Array.from(map)) {\n        if (item.js === String) {\n          return item.sql;\n        }\n      }\n\n      return TYPES.NVarChar;\n\n    case 'number':\n      if (value % 1 === 0) {\n        return TYPES.Int;\n      } else {\n        return TYPES.Float;\n      }\n\n    case 'boolean':\n      for (item of Array.from(map)) {\n        if (item.js === Boolean) {\n          return item.sql;\n        }\n      }\n\n      return TYPES.Bit;\n\n    case 'object':\n      for (item of Array.from(map)) {\n        if (value instanceof item.js) {\n          return item.sql;\n        }\n      }\n\n      return TYPES.NVarChar;\n\n    default:\n      return TYPES.NVarChar;\n  }\n};\n\nmodule.exports = {\n  driver,\n  getTypeByValue,\n  map\n};\nObject.defineProperty(module.exports, 'Promise', {\n  get: () => {\n    return PromiseLibrary;\n  },\n  set: value => {\n    PromiseLibrary = value;\n  }\n});","map":{"version":3,"sources":["C:/Projects/sqlsample/node_modules/mssql/lib/shared.js"],"names":["TYPES","require","Table","PromiseLibrary","Promise","driver","map","register","jstype","sqltype","index","length","item","js","splice","push","sql","String","NVarChar","Number","Int","Boolean","Bit","Date","DateTime","Buffer","VarBinary","TVP","getTypeByValue","value","undefined","Array","from","Float","module","exports","Object","defineProperty","get","set"],"mappings":"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","sourcesContent":["'use strict'\r\n\r\nconst TYPES = require('./datatypes').TYPES\r\nconst Table = require('./table')\r\n\r\nlet PromiseLibrary = Promise\r\nconst driver = {}\r\nconst map = []\r\n\r\n/**\r\n * Register you own type map.\r\n *\r\n * @path module.exports.map\r\n * @param {*} jstype JS data type.\r\n * @param {*} sqltype SQL data type.\r\n */\r\n\r\nmap.register = function (jstype, sqltype) {\r\n  for (let index = 0; index < this.length; index++) {\r\n    const item = this[index]\r\n    if (item.js === jstype) {\r\n      this.splice(index, 1)\r\n      break\r\n    }\r\n  }\r\n\r\n  this.push({\r\n    js: jstype,\r\n    sql: sqltype\r\n  })\r\n\r\n  return null\r\n}\r\n\r\nmap.register(String, TYPES.NVarChar)\r\nmap.register(Number, TYPES.Int)\r\nmap.register(Boolean, TYPES.Bit)\r\nmap.register(Date, TYPES.DateTime)\r\nmap.register(Buffer, TYPES.VarBinary)\r\nmap.register(Table, TYPES.TVP)\r\n\r\n/**\r\n * @ignore\r\n */\r\n\r\nconst getTypeByValue = function (value) {\r\n  if ((value === null) || (value === undefined)) { return TYPES.NVarChar }\r\n\r\n  switch (typeof value) {\r\n    case 'string':\r\n      for (var item of Array.from(map)) {\r\n        if (item.js === String) {\r\n          return item.sql\r\n        }\r\n      }\r\n\r\n      return TYPES.NVarChar\r\n\r\n    case 'number':\r\n      if (value % 1 === 0) {\r\n        return TYPES.Int\r\n      } else {\r\n        return TYPES.Float\r\n      }\r\n\r\n    case 'boolean':\r\n      for (item of Array.from(map)) {\r\n        if (item.js === Boolean) {\r\n          return item.sql\r\n        }\r\n      }\r\n\r\n      return TYPES.Bit\r\n\r\n    case 'object':\r\n      for (item of Array.from(map)) {\r\n        if (value instanceof item.js) {\r\n          return item.sql\r\n        }\r\n      }\r\n\r\n      return TYPES.NVarChar\r\n\r\n    default:\r\n      return TYPES.NVarChar\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  driver,\r\n  getTypeByValue,\r\n  map\r\n}\r\n\r\nObject.defineProperty(module.exports, 'Promise', {\r\n  get: () => {\r\n    return PromiseLibrary\r\n  },\r\n  set: (value) => {\r\n    PromiseLibrary = value\r\n  }\r\n})\r\n"]},"metadata":{},"sourceType":"script"}